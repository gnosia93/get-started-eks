## EC2 Migration to Graviton ##

* [#1. VPC 생성하기](https://github.com/gnosia93/get-started-eks/tree/main/cf)
* [#2. ALB 에 Graviton 추가히기(수동)](https://github.com/gnosia93/get-started-eks/blob/main/ec2/c2-add-graviton-to-alb.md)
* [#3. 롤아웃(Rolling Update / Rollout)](https://github.com/gnosia93/get-started-eks/blob/main/ec2/c3-rollout-graviton.md)
* [#4. 카나리(Canary) / 블루그린(Blue-Green)]()

## 배포 ##

### 1. 카나리(Canary) 및 블루-그린(Blue-Green) 구현 ###
ALB의 리스너 규칙에서 하나의 규칙에 두 개의 타겟 그룹을 연결하고 가중치를 부여하면 한다.
* 설정 방법: ALB 리스너 편집 → 규칙(Rule) 수정 → 전달 대상(Forward to)에 Target Group A(기존/Blue)와 Target Group B(신규/Green)를 모두 추가.
* 가중치 조절:
  * 카나리: A: 95% / B: 5%로 설정하여 신규(ARM) 인스턴스로 소량의 트래픽만 흘려보내 성능을 검증.
  * 블루-그린: 검증이 끝나면 A: 0% / B: 100%로 가중치를 변경하여 즉시 전환.



## 혼합 구성 (Instance Types Mixed) 및 운영 ##
하나의 ASG 내에서 x86과 ARM을 동시에 띄우고 싶다면 혼합 인스턴스 정책(Mixed Instances Policy)을 사용할 수 있다. 

#### Option 1. 인스턴스 요구 사항(Attribute-based selection) 설정 ###
* 특정 인스턴스 유형(t3.medium 등)을 지정하는 대신 "vCPU 2개, 메모리 4GB" 같은 사양(Attribute)을 지정.
* Allowed instance types 목록에 x86(t3)과 ARM(t4g)을 모두 포함시킵니다.
* 주의: 사용 중인 AMI가 x86과 ARM을 모두 지원해야 한다.

#### Option 2. 별도의 ASG 운영 (실무 권장) ###
x86용 ASG와 ARM용 ASG를 각각 만든 뒤, 동일한 ALB 타겟 그룹에 두 ASG를 모두 연결한다.
ALB는 어느 ASG에서 왔는지 상관없이 가용 인스턴스에 트래픽을 분산한다.

